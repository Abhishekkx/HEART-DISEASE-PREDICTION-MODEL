<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heart Disease Prediction System</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            padding: 40px 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .nav-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 10px;
            backdrop-filter: blur(10px);
        }

        .nav-tab {
            padding: 15px 30px;
            margin: 0 5px;
            background: transparent;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 500;
        }

        .nav-tab:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .nav-tab.active {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .tab-content {
            display: none;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-bottom: 20px;
            animation: fadeIn 0.5s ease-in;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            border: 1px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .card h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
            font-size: 1.5rem;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(52, 152, 219, 0.3);
        }

        .btn-success {
            background: linear-gradient(45deg, #27ae60, #229954);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(45deg, #f39c12, #e67e22);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
        }

        .prediction-result {
            padding: 25px;
            border-radius: 15px;
            margin-top: 20px;
            text-align: center;
            font-size: 1.2rem;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .high-risk {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
            border: 3px solid #c0392b;
        }

        .low-risk {
            background: linear-gradient(45deg, #2ecc71, #27ae60);
            color: white;
            border: 3px solid #229954;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .stat-card h4 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .stat-card p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .file-upload {
            border: 3px dashed #3498db;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            background: #f8f9fa;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .file-upload:hover {
            background: #e9ecef;
            border-color: #2980b9;
        }

        .file-upload.dragover {
            background: #e3f2fd;
            border-color: #1976d2;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2980b9);
            transition: width 0.3s ease;
        }

        .dataset-preview {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 10px;
        }

        .dataset-table {
            width: 100%;
            border-collapse: collapse;
        }

        .dataset-table th, .dataset-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .dataset-table th {
            background: #f1f3f4;
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        .dataset-table tr:hover {
            background: #f8f9fa;
        }

        .alert {
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .alert-info {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            color: #1565c0;
        }

        .alert-warning {
            background: #fff3e0;
            border: 1px solid #ff9800;
            color: #ef6c00;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .nav-tabs {
                flex-wrap: wrap;
            }
            
            .nav-tab {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
            
            .feature-grid {
                grid-template-columns: 1fr;
            }
        }

        .analysis-report {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #e0e0e0;
        }

        .analysis-report h4 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .chart-container {
            max-width: 600px;
            margin: 20px auto;
        }

        .training-image {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            margin: 10px 0;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🫀 Heart Disease Prediction System</h1>
            <p>AI-powered cardiovascular risk assessment using deep learning</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('overview')">📊 Overview</button>
            <button class="nav-tab" onclick="showTab('predict')">🔮 Prediction</button>
            <button class="nav-tab" onclick="showTab('batch')">📁 Batch Analysis</button>
            <button class="nav-tab" onclick="showTab('datasets')">📋 Datasets</button>
            <button class="nav-tab" onclick="showTab('analytics')">📈 Analytics</button>
            <button class="nav-tab" onclick="showTab('about')">ℹ️ About</button>
            <button class="nav-tab" onclick="showTab('trainingReports')">📋 Training Reports</button>
        </div>

        <!-- Overview Tab -->
        <div id="overview" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <h4>3</h4>
                    <p>Datasets Combined</p>
                </div>
                <div class="stat-card">
                    <h4>26</h4>
                    <p>Features Analyzed</p>
                </div>
                <div class="stat-card">
                    <h4>74.4%</h4>
                    <p>Model Accuracy</p>
                </div>
                <div class="stat-card">
                    <h4>75K+</h4>
                    <p>Training Samples</p>
                </div>
            </div>

            <div class="card">
                <h3>🎯 Project Highlights</h3>
                <div class="alert alert-info">
                    <strong>Multi-Dataset Integration:</strong> Combined UCI Heart Disease, Framingham Heart Study, and Cardio Train datasets for robust predictions.
                </div>
                <ul style="line-height: 2; margin-left: 20px;">
                    <li><strong>Preprocessing:</strong> Standardized features using StandardScaler and handled missing values with medians.</li>
                    <li><strong>Neural Network:</strong> Keras Sequential model with dropout to prevent overfitting.</li>
                    <li><strong>Real-time Prediction:</strong> Instant risk assessment for individual patients.</li>
                    <li><strong>Batch Processing:</strong> Analyze multiple patients via CSV upload.</li>
                    <li><strong>Exploratory Analysis:</strong> Correlation heatmaps and class balance visualization.</li>
                </ul>
            </div>

            <div class="card">
                <h3>🧠 Model Architecture</h3>
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; font-family: monospace;">
                    <div style="margin-bottom: 10px;">Input Layer: 26 features</div>
                    <div style="margin-bottom: 10px;">Hidden Layer 1: 128 neurons (ReLU) + Dropout (0.4)</div>
                    <div style="margin-bottom: 10px;">Hidden Layer 2: 64 neurons (ReLU)</div>
                    <div>Output Layer: 1 neuron (Sigmoid)</div>
                </div>
            </div>
        </div>

        <!-- Prediction Tab -->
        <div id="predict" class="tab-content">
            <div class="card">
                <h3>🏥 Patient Information</h3>
                <div class="alert alert-info">
                    Enter patient data below. Healthy ranges: Age (18–50), BP (90–120 mmHg), Cholesterol (<200 mg/dL), Max HR (140–190), BMI (18.5–24.9).
                </div>
                <form id="predictionForm">
                    <div class="feature-grid">
                        <div class="form-group">
                            <label>Age (years)</label>
                            <input type="number" id="age" min="0" max="120" value="21" required>
                        </div>
                        <div class="form-group">
                            <label>Sex</label>
                            <select id="sex" required>
                                <option value="1">Male</option>
                                <option value="0">Female</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Resting Blood Pressure (mmHg)</label>
                            <input type="number" id="trestbps" min="0" max="300" value="120">
                        </div>
                        <div class="form-group">
                            <label>Cholesterol (mg/dl)</label>
                            <input type="number" id="chol" min="0" max="600" value="180">
                        </div>
                        <div class="form-group">
                            <label>Fasting Blood Sugar > 120 mg/dl</label>
                            <select id="fbs">
                                <option value="0">No</option>
                                <option value="1">Yes</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Resting ECG Results</label>
                            <select id="restecg">
                                <option value="0">Normal</option>
                                <option value="1">ST-T Wave Abnormality</option>
                                <option value="2">Left Ventricular Hypertrophy</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Maximum Heart Rate</label>
                            <input type="number" id="thalch" min="0" max="220" value="150">
                        </div>
                        <div class="form-group">
                            <label>Exercise Induced Angina</label>
                            <select id="exang">
                                <option value="0">No</option>
                                <option value="1">Yes</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ST Depression</label>
                            <input type="number" id="oldpeak" min="-10" max="10" step="0.1" value="1.0">
                        </div>
                        <div class="form-group">
                            <label>Slope of Peak Exercise ST Segment</label>
                            <select id="slope">
                                <option value="0">Upsloping</option>
                                <option value="1">Flat</option>
                                <option value="2">Downsloping</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Number of Major Vessels (0–3)</label>
                            <input type="number" id="ca" min="0" max="4" value="0">
                        </div>
                        <div class="form-group">
                            <label>Thalassemia</label>
                            <select id="thal">
                                <option value="0">None</option>
                                <option value="1">Normal</option>
                                <option value="2">Fixed Defect</option>
                                <option value="3">Reversible Defect</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Systolic BP (mmHg)</label>
                            <input type="number" id="sysBP" min="0" max="300" value="120">
                        </div>
                        <div class="form-group">
                            <label>Diastolic BP (mmHg)</label>
                            <input type="number" id="diaBP" min="0" max="200" value="80">
                        </div>
                        <div class="form-group">
                            <label>Glucose (mg/dL)</label>
                            <input type="number" id="glucose" min="0" max="500" value="85">
                        </div>
                        <div class="form-group">
                            <label>Blood Pressure Medication</label>
                            <select id="BPMeds">
                                <option value="0">No</option>
                                <option value="1">Yes</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Diabetes</label>
                            <select id="diabetes">
                                <option value="0">No</option>
                                <option value="1">Yes</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Height (cm)</label>
                            <input type="number" id="height" min="0" max="250" value="170">
                        </div>
                        <div class="form-group">
                            <label>Weight (kg)</label>
                            <input type="number" id="weight" min="0" max="300" value="75">
                        </div>
                        <div class="form-group">
                            <label>Systolic BP (Cardio)</label>
                            <input type="number" id="ap_hi" min="0" max="300" value="120">
                        </div>
                        <div class="form-group">
                            <label>Diastolic BP (Cardio)</label>
                            <input type="number" id="ap_lo" min="0" max="200" value="80">
                        </div>
                        <div class="form-group">
                            <label>Cholesterol Level</label>
                            <select id="cholesterol">
                                <option value="1">Normal</option>
                                <option value="2">Above Normal</option>
                                <option value="3">Well Above Normal</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Glucose Level</label>
                            <select id="gluc">
                                <option value="1">Normal</option>
                                <option value="2">Above Normal</option>
                                <option value="3">Well Above Normal</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Smoking</label>
                            <select id="smoke">
                                <option value="0">No</option>
                                <option value="1">Yes</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Alcohol Intake</label>
                            <select id="alco">
                                <option value="0">No</option>
                                <option value="1">Yes</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Physical Activity</label>
                            <select id="active">
                                <option value="0">No</option>
                                <option value="1">Yes</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <span id="predictLoading" class="loading" style="display: none;"></span>
                        🔮 Predict Risk
                    </button>
                </form>
                <div id="predictionResult"></div>
                <div id="analysisReport" class="analysis-report" style="display: none;">
                    <h4>📊 Analysis Report</h4>
                    <div id="featureImportance"></div>
                </div>
            </div>
        </div>

        <!-- Batch Analysis Tab -->
        <div id="batch" class="tab-content">
            <div class="card">
                <h3>📁 Batch File Analysis</h3>
                <div class="file-upload" id="fileUpload">
                    <div style="font-size: 3rem; margin-bottom: 20px;">📄</div>
                    <h4>Upload CSV File</h4>
                    <p>Drag and drop your CSV file here or click to browse. Ensure columns match expected features.</p>
                    <input type="file" id="csvFile" accept=".csv" style="display: none;">
                    <button onclick="document.getElementById('csvFile').click()" class="btn btn-primary" style="margin-top: 15px;">
                        Browse Files
                    </button>
                </div>
                <div id="batchResults"></div>
                <div id="batchAnalysis" class="analysis-report" style="display: none;">
                    <h4>📊 Batch Analysis Report</h4>
                    <div id="batchStats"></div>
                </div>
            </div>
        </div>

        <!-- Datasets Tab -->
        <div id="datasets" class="tab-content">
            <div class="card">
                <h3>📊 Dataset Information</h3>
                
                <div style="margin-bottom: 30px;">
                    <h4 style="color: #3498db; margin-bottom: 15px;">1. UCI Heart Disease Dataset</h4>
                    <p><strong>Source:</strong> UCI Machine Learning Repository (Cleveland Clinic)</p>
                    <p><strong>Samples:</strong> ~1,025 patients</p>
                    <p><strong>Features:</strong> Age, Sex, Chest Pain Type, Resting BP, Cholesterol, Max HR, etc.</p>
                    <div class="alert alert-info">
                        Comprehensive diagnostic data from multiple medical centers.
                    </div>
                </div>

                <div style="margin-bottom: 30px;">
                    <h4 style="color: #3498db; margin-bottom: 15px;">2. Framingham Heart Study</h4>
                    <p><strong>Source:</strong> Kaggle</p>
                    <p><strong>Samples:</strong> ~4,238 participants</p>
                    <p><strong>Features:</strong> Age, Sex, Systolic/Diastolic BP, Glucose, BMI, Smoking, etc.</p>
                    <div class="alert alert-info">
                        Longitudinal study focusing on cardiovascular risk factors.
                    </div>
                </div>

                <div style="margin-bottom: 30px;">
                    <h4 style="color: #3498db; margin-bottom: 15px;">3. Cardio Train Dataset</h4>
                    <p><strong>Source:</strong> Kaggle (Electronic Health Record Simulation)</p>
                    <p><strong>Samples:</strong> ~70,000 patients</p>
                    <p><strong>Features:</strong> Age, Height, Weight, Blood Pressure, Cholesterol, Glucose, Smoking, etc.</p>
                    <div class="alert alert-info">
                        Large-scale dataset with clinical and lifestyle data for robust analysis.
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>📋 Sample Data Preview</h3>
                <div class="dataset-preview">
                    <table class="dataset-table">
                        <thead>
                            <tr>
                                <th>Age</th>
                                <th>Sex</th>
                                <th>BP</th>
                                <th>Cholesterol</th>
                                <th>Heart Rate</th>
                                <th>Risk</th>
                            </tr>
                        </thead>
                        <tbody id="sampleData">
                            <tr><td>45</td><td>Male</td><td>120</td><td>180</td><td>150</td><td>Low</td></tr>
                            <tr><td>30</td><td>Female</td><td>110</td><td>190</td><td>170</td><td>Low</td></tr>
                            <tr><td>55</td><td>Male</td><td>140</td><td>220</td><td>130</td><td>High</td></tr>
                            <tr><td>40</td><td>Female</td><td>115</td><td>175</td><td>160</td><td>Low</td></tr>
                            <tr><td>60</td><td>Male</td><td>150</td><td>230</td><td>120</td><td>High</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Analytics Tab -->
        <div id="analytics" class="tab-content">
            <div class="card">
                <h3>📈 Model Performance</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h4>74.4%</h4>
                        <p>Accuracy</p>
                    </div>
                    <div class="stat-card">
                        <h4 id="precision">N/A</h4>
                        <p>Precision</p>
                    </div>
                    <div class="stat-card">
                        <h4 id="recall">N/A</h4>
                        <p>Recall</p>
                    </div>
                    <div class="stat-card">
                        <h4 id="f1-score">N/A</h4>
                        <p>F1-Score</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>🎯 Training Progress</h3>
                <div class="chart-container">
                    <canvas id="trainingChart"></canvas>
                </div>
                <div id="trainingMetrics">
                    <p><strong>Final Loss:</strong> <span id="finalLoss">N/A</span></p>
                    <p><strong>Final Accuracy:</strong> <span id="finalAccuracy">N/A</span></p>
                </div>
            </div>

            <div class="card">
                <h3>🔍 Feature Importance</h3>
                <div id="featureImportanceChart">
                    <div style="margin-bottom: 15px;">
                        <strong>Age:</strong> High importance
                        <div class="progress-bar"><div class="progress-fill" style="width: 85%;"></div></div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong>Blood Pressure:</strong> High importance
                        <div class="progress-bar"><div class="progress-fill" style="width: 80%;"></div></div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong>Cholesterol:</strong> Medium importance
                        <div class="progress-bar"><div class="progress-fill" style="width: 75%;"></div></div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong>Max Heart Rate:</strong> Medium importance
                        <div class="progress-bar"><div class="progress-fill" style="width: 70%;"></div></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- About Tab -->
        <div id="about" class="tab-content">
            <div class="card">
                <h3>ℹ️ About This Project</h3>
                <p style="line-height: 1.8; margin-bottom: 20px;">
                    The Heart Disease Prediction System is a machine learning application designed to predict cardiovascular risk using clinical, demographic, and lifestyle data. It combines three real-world datasets to train a neural network with ~74.4% accuracy.
                </p>
                
                <h4 style="color: #3498db; margin: 25px 0 15px 0;">🎯 Key Features</h4>
                <ul style="line-height: 2; margin-left: 20px; margin-bottom: 25px;">
                    <li>Multi-dataset integration for robust predictions</li>
                    <li>Deep neural network with dropout regularization</li>
                    <li>Real-time individual risk assessment</li>
                    <li>Batch processing for multiple patients</li>
                    <li>Interactive web interface</li>
                    <li>Data analysis visualization</li>
                </ul>

                <h4 style="color: #3498db; margin: 25px 0 15px 0;">🔬 Technical Implementation</h4>
                <ul style="line-height: 2; margin-left: 20px; margin-bottom: 25px;">
                    <li><strong>Framework:</strong> TensorFlow/Keras</li>
                    <li><strong>Preprocessing:</strong> StandardScaler, median imputation</li>
                    <li><strong>Architecture:</strong> Sequential neural network with dropout</li>
                    <li><strong>Validation:</strong> Stratified train-test split</li>
                    <li><strong>Metrics:</strong> Accuracy, Precision, Recall, F1-Score</li>
                </ul>

                <div class="alert alert-warning">
                    <strong>Disclaimer:</strong> For educational purposes only. Consult healthcare professionals for medical advice.
                </div>
            </div>

            <div class="card">
                <h3>👨‍💻 Development Team</h3>
                <p style="line-height: 1.8;">
                    Developed using modern machine learning practices, focusing on robust preprocessing, deep learning, and user-friendly design.
                </p>
            </div>
        </div>

        <!-- Training Reports Tab -->
        <div id="trainingReports" class="tab-content">
            <div class="card">
                <h3>📋 Training Reports</h3>
                <div class="analysis-report">
                    <h4>📊 Training Visualizations and Reports</h4>
                    <img src="/static/images/training.png" alt="UCI Target Distribution" class="training-image">
                    <img src="/static/images/fram tgt.png" alt="Framingham Target Distribution" class="training-image">
                    <img src="/static/images/cardio_tgt.png" alt="Cardio Target Distribution" class="training-image">
                    <img src="/static/images/UCI correlation matrix.png" alt="UCI Correlation Matrix" class="training-image">
                    <img src="/static/images/confucion matrix.png" alt="Confusion Matrix" class="training-image">
                    <img src="/static/images/loss acc epoch.png" alt="Loss and Accuracy Over Epochs" class="training-image">
                    <p><strong>Training Report:</strong> <a href="https://colab.research.google.com/drive/1snzfRGRjCBCQvUzmHqDIQCcqA-BAxSSq?usp=sharing" target="_blank">Colab Notebook</a></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab switching
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            if (tabName === 'analytics') {
                fetchTrainingMetrics();
            }
        }

        // Feature ranges for validation
        const featureRanges = {
            'age': [0, 120], 'sex': [0, 1], 'trestbps': [0, 300], 'chol': [0, 600], 'fbs': [0, 1],
            'restecg': [0, 3], 'thalch': [0, 220], 'exang': [0, 1], 'oldpeak': [-10, 10], 
            'slope': [0, 3], 'ca': [0, 4], 'thal': [0, 3], 'sysBP': [0, 300], 'diaBP': [0, 200],
            'glucose': [0, 500], 'BPMeds': [0, 1], 'diabetes': [0, 1], 'height': [0, 250],
            'weight': [0, 300], 'ap_hi': [0, 300], 'ap_lo': [0, 200], 'cholesterol': [1, 3],
            'gluc': [1, 3], 'smoke': [0, 1], 'alco': [0, 1], 'active': [0, 1]
        };

        // File upload drag-and-drop
        const fileUpload = document.getElementById('fileUpload');
        const csvFileInput = document.getElementById('csvFile');

        fileUpload.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUpload.classList.add('dragover');
        });

        fileUpload.addEventListener('dragleave', () => {
            fileUpload.classList.remove('dragover');
        });

        fileUpload.addEventListener('drop', (e) => {
            e.preventDefault();
            fileUpload.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                csvFileInput.files = files;
                handleFileUpload(files[0]);
            }
        });

        csvFileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFileUpload(e.target.files[0]);
            }
        });

        // Prediction form submission
        document.getElementById('predictionForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const loadingSpinner = document.getElementById('predictLoading');
            const resultDiv = document.getElementById('predictionResult');
            const analysisDiv = document.getElementById('analysisReport');
            const featureImportanceDiv = document.getElementById('featureImportance');
            loadingSpinner.style.display = 'inline-block';
            resultDiv.innerHTML = '';
            analysisDiv.style.display = 'none';

            try {
                // Collect input data
                const inputData = {
                    age: parseFloat(document.getElementById('age').value),
                    sex: parseInt(document.getElementById('sex').value),
                    trestbps: parseFloat(document.getElementById('trestbps').value),
                    chol: parseFloat(document.getElementById('chol').value),
                    fbs: parseInt(document.getElementById('fbs').value),
                    restecg: parseInt(document.getElementById('restecg').value),
                    thalch: parseFloat(document.getElementById('thalch').value),
                    exang: parseInt(document.getElementById('exang').value),
                    oldpeak: parseFloat(document.getElementById('oldpeak').value),
                    slope: parseInt(document.getElementById('slope').value),
                    ca: parseFloat(document.getElementById('ca').value),
                    thal: parseInt(document.getElementById('thal').value),
                    sysBP: parseFloat(document.getElementById('sysBP').value),
                    diaBP: parseFloat(document.getElementById('diaBP').value),
                    glucose: parseFloat(document.getElementById('glucose').value),
                    BPMeds: parseInt(document.getElementById('BPMeds').value),
                    diabetes: parseInt(document.getElementById('diabetes').value),
                    height: parseFloat(document.getElementById('height').value),
                    weight: parseFloat(document.getElementById('weight').value),
                    ap_hi: parseFloat(document.getElementById('ap_hi').value),
                    ap_lo: parseFloat(document.getElementById('ap_lo').value),
                    cholesterol: parseInt(document.getElementById('cholesterol').value),
                    gluc: parseInt(document.getElementById('gluc').value),
                    smoke: parseInt(document.getElementById('smoke').value),
                    alco: parseInt(document.getElementById('alco').value),
                    active: parseInt(document.getElementById('active').value)
                };

                // Client-side validation
                for (const [feature, value] of Object.entries(inputData)) {
                    if (feature in featureRanges) {
                        const [min, max] = featureRanges[feature];
                        if (isNaN(value) || value < min || value > max) {
                            throw new Error(`${feature} value ${value} is out of range [${min}, ${max}]`);
                        }
                    }
                }

                // Send prediction request
                const response = await fetch('http://localhost:5000/api/predict', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ data: [inputData] })
                });

                if (!response.ok) {
                    throw new Error(`Prediction request failed: ${response.statusText}`);
                }

                const result = await response.json();
                if (result.error) {
                    throw new Error(result.error);
                }

                const prob = result.probabilities[0];
                const isHighRisk = prob > 0.5;

                resultDiv.innerHTML = `
                    <div class="prediction-result ${isHighRisk ? 'high-risk' : 'low-risk'}">
                        <h3>🫀 Prediction Result</h3>
                        <p><strong>Risk Probability: ${prob.toFixed(3)}</strong></p>
                        <p style="font-size: 1.5rem; margin: 15px 0;">
                            ${isHighRisk ? '⚠️ High Risk' : '✅ Low Risk'}
                        </p>
                        <p style="font-size: 0.9rem; opacity: 0.8;">
                            ${isHighRisk ? 
                                'Consult a healthcare professional for further evaluation.' : 
                                'Maintain healthy lifestyle and regular check-ups.'}
                        </p>
                    </div>`;

                // Mock feature importance (replace with actual backend endpoint if available)
                analysisDiv.style.display = 'block';
                featureImportanceDiv.innerHTML = `
                    <p><strong>Key Contributors:</strong></p>
                    <ul>
                        <li>Age: ${inputData.age > 50 ? 'High impact (Age > 50)' : 'Moderate impact'}</li>
                        <li>Blood Pressure: ${inputData.trestbps > 120 ? 'High impact (BP > 120)' : 'Low impact'}</li>
                        <li>Cholesterol: ${inputData.chol > 200 ? 'High impact (Chol > 200)' : 'Low impact'}</li>
                    </ul>
                `;
            } catch (error) {
                console.error('Prediction error:', error);
                resultDiv.innerHTML = `
                    <div class="alert alert-warning">
                        Error: ${error.message}. Please ensure the backend server is running at http://localhost:5000.
                    </div>`;
            } finally {
                loadingSpinner.style.display = 'none';
            }
        });

        // Handle batch file upload
        async function handleFileUpload(file) {
            const batchResults = document.getElementById('batchResults');
            const batchAnalysis = document.getElementById('batchAnalysis');
            const batchStats = document.getElementById('batchStats');
            batchResults.innerHTML = '<div class="loading"></div>';
            batchAnalysis.style.display = 'none';

            try {
                if (!file.name.endsWith('.csv')) {
                    throw new Error('Please upload a CSV file');
                }

                const formData = new FormData();
                formData.append('file', file);

                const response = await fetch('http://localhost:5000/api/predict/batch', {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) {
                    throw new Error(`Batch prediction failed: ${response.statusText}`);
                }

                const result = await response.json();
                if (result.error) {
                    throw new Error(result.error);
                }

                let html = '<div class="prediction-result">';
                html += '<h3>📊 Batch Prediction Results</h3>';
                html += '<table class="dataset-table"><thead><tr><th>Patient</th><th>Probability</th><th>Risk</th></tr></thead><tbody>';

                let highRiskCount = 0;
                result.probabilities.forEach((prob, idx) => {
                    const isHighRisk = prob > 0.5;
                    if (isHighRisk) highRiskCount++;
                    html += `
                        <tr>
                            <td>Patient ${idx + 1}</td>
                            <td>${prob.toFixed(3)}</td>
                            <td style="color: ${isHighRisk ? '#c0392b' : '#27ae60'}">
                                ${isHighRisk ? '⚠️ High Risk' : '✅ Low Risk'}
                            </td>
                        </tr>`;
                });

                html += '</tbody></table>';
                batchResults.innerHTML = html;

                // Batch analysis
                batchAnalysis.style.display = 'block';
                batchStats.innerHTML = `
                    <p><strong>Total Patients:</strong> ${result.probabilities.length}</p>
                    <p><strong>High-Risk Patients:</strong> ${highRiskCount} (${(highRiskCount / result.probabilities.length * 100).toFixed(1)}%)</p>
                    <p><strong>Low-Risk Patients:</strong> ${result.probabilities.length - highRiskCount}</p>
                `;
            } catch (error) {
                console.error('Batch prediction error:', error);
                batchResults.innerHTML = `
                    <div class="alert alert-warning">
                        Error: ${error.message}. Please ensure the backend server is running at http://localhost:5000.
                    </div>`;
            }
        }

        // Fetch training metrics for analytics tab with retry
        let trainingChart;
        async function fetchTrainingMetrics(retries = 3, delay = 1000) {
            try {
                const response = await fetch('http://localhost:5000/api/metrics');
                if (!response.ok) {
                    throw new Error(`Metrics request failed: ${response.statusText}`);
                }
                const metrics = await response.json();
                if (metrics.error) {
                    throw new Error(metrics.error);
                }

                // Update metrics
                document.getElementById('precision').textContent = `${(metrics.precision * 100).toFixed(1)}%`;
                document.getElementById('recall').textContent = `${(metrics.recall * 100).toFixed(1)}%`;
                document.getElementById('f1-score').textContent = `${(metrics.f1_score * 100).toFixed(1)}%`;
                document.getElementById('finalLoss').textContent = metrics.loss[metrics.loss.length - 1].toFixed(2);
                document.getElementById('finalAccuracy').textContent = `${(metrics.val_accuracy[metrics.val_accuracy.length - 1] * 100).toFixed(1)}%`;

                // Render training chart
                if (trainingChart) trainingChart.destroy();
                trainingChart = new Chart(document.getElementById('trainingChart'), {
                    type: 'line',
                    data: {
                        labels: Array.from({length: metrics.loss.length}, (_, i) => `Epoch ${i + 1}`),
                        datasets: [
                            {
                                label: 'Training Loss',
                                data: metrics.loss,
                                borderColor: '#3498db',
                                fill: false
                            },
                            {
                                label: 'Validation Loss',
                                data: metrics.val_loss,
                                borderColor: '#e74c3c',
                                fill: false
                            },
                            {
                                label: 'Training Accuracy',
                                data: metrics.accuracy.map(x => x * 100),
                                borderColor: '#2ecc71',
                                fill: false
                            },
                            {
                                label: 'Validation Accuracy',
                                data: metrics.val_accuracy.map(x => x * 100),
                                borderColor: '#f39c12',
                                fill: false
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: { display: true, text: 'Value' }
                            },
                            x: {
                                title: { display: true, text: 'Epoch' }
                            }
                        }
                    }
                });
            } catch (error) {
                console.error('Metrics error:', error);
                if (retries > 0) {
                    console.log(`Retrying metrics fetch (${retries} attempts left)...`);
                    setTimeout(() => fetchTrainingMetrics(retries - 1, delay * 2), delay);
                } else {
                    document.getElementById('trainingMetrics').innerHTML += `
                        <div class="alert alert-warning">
                            Failed to load training metrics. Please ensure the backend server is running.
                        </div>`;
                }
            }
        }
    </script>
</body>
</html>